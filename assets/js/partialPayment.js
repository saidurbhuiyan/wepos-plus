(()=>{var __webpack_modules__={"./assets/src/utils/partialPayment.js":
/*!********************************************!*\
  !*** ./assets/src/utils/partialPayment.js ***!
  \********************************************/()=>{eval("jQuery(document).ready(function ($) {\n  const partialPaymentButton = $('#update_partial_payment_button');\n  $('#partial_payment_method').on('change', function () {\n    if ($(this).val() === 'Cash & Card') {\n      $('#partial_single_amount').hide();\n      $('#partial_cash_card_amount').show();\n    } else {\n      $('#partial_single_amount').show();\n      $('#partial_cash_card_amount').hide();\n    }\n  });\n  // Function to handle form submission\n  function handlePartialPaymentFormSubmission() {\n    // Get REST API endpoint and nonce from restApiSettings\n    const ajaxUrl = restApiSettings.restUrl;\n    const nonce = restApiSettings.nonce;\n\n    // Get partial payment amount and order ID from form fields\n    let partialPaymentAmount = $('#partial_payment_amount').val();\n    const partialPaymentMethod = $('#partial_payment_method').val();\n    let cashCardAmount = {\n      cash: '',\n      card: ''\n    };\n    if (partialPaymentMethod === 'Cash & Card') {\n      partialPaymentAmount = parseFloat($('#partial_cash_payment_amount').val()) + parseFloat($('#partial_card_payment_amount').val());\n      cashCardAmount = {\n        cash: $('#partial_cash_payment_amount').val(),\n        card: $('#partial_card_payment_amount').val()\n      };\n    }\n    const orderId = $('#partial_payment_id').val();\n    partialPaymentButton.prop('disabled', true).text('Please wait...');\n\n    // Clear any previous messages from local storage\n    localStorage.removeItem('partialPaymentMessage');\n\n    // AJAX request configuration\n    $.ajax({\n      type: 'POST',\n      url: ajaxUrl,\n      beforeSend: function (xhr) {\n        xhr.setRequestHeader('X-WP-Nonce', nonce); // Set nonce header for security\n      },\n      data: {\n        order_id: orderId,\n        partial_amount: partialPaymentAmount,\n        partial_method: partialPaymentMethod,\n        cash_card_amount: cashCardAmount\n      },\n      success: function (response) {\n        // Check response for success\n        if (response.result === 'success') {\n          // Store success message temporarily in local storage\n          localStorage.setItem('partialPaymentMessage', JSON.stringify({\n            type: 'success',\n            message: 'Partial payment updated successfully!'\n          }));\n        } else {\n          // Store error message temporarily in local storage\n          localStorage.setItem('partialPaymentMessage', JSON.stringify({\n            type: 'error',\n            message: 'Error: ' + response.message\n          }));\n        }\n\n        // Reload the page\n        location.reload();\n      },\n      error: function (error) {\n        // Store error message temporarily in local storage\n        localStorage.setItem('partialPaymentMessage', JSON.stringify({\n          type: 'error',\n          message: 'Error: Failed to update partial payment.'\n        }));\n\n        // Reload the page\n        location.reload();\n      }\n    });\n  }\n\n  // Bind form submission handler\n  partialPaymentButton.on('click', handlePartialPaymentFormSubmission);\n\n  // Check for stored message on page load and display it\n  const storedMessage = JSON.parse(localStorage.getItem('partialPaymentMessage'));\n  if (storedMessage && storedMessage.message) {\n    const messageClass = storedMessage.type === 'success' ? 'woocommerce-message notice notice-success' : 'woocommerce-error notice notice-error';\n    $('.woocommerce-notices-wrapper').html('<div class=\"' + messageClass + '\">' + storedMessage.message + '</div>');\n    $('.wrap').prepend('<div class=\"' + messageClass + ' is-dismissible\"><p>' + storedMessage.message + '</p></div>');\n\n    // Clear stored message after displaying it\n    localStorage.removeItem('partialPaymentMessage');\n  }\n});\n\n//# sourceURL=webpack://wepos/./assets/src/utils/partialPayment.js?")}},__webpack_exports__={};__webpack_modules__["./assets/src/utils/partialPayment.js"]()})();