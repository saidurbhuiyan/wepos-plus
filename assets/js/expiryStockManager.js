(()=>{var __webpack_modules__={"./assets/src/utils/expiryStockManager.js":
/*!************************************************!*\
  !*** ./assets/src/utils/expiryStockManager.js ***!
  \************************************************/()=>{eval("jQuery(document).ready(function ($) {\n  const expiryFieldsContainer = $('#expiry_date_fields');\n  const expiryInput = $('#expiry_input');\n  const expiryRule = $('#_expiry_rule');\n  const stockQuantity = $('#_stock');\n  const manageStock = $('#_manage_stock');\n  const addExpiryButton = $('button.add-expiry-field');\n\n  // Helper to create expiry field HTML.\n  function createExpiryField(index) {\n    const removeButton = index > 0 ? '<button type=\"button\" class=\"remove-expiry-field\">&times;</button>' : '<span style=\"padding: 0 14px;\"></span>';\n    return `\n            <tr class=\"form-field expiry-field-group\">\n                <td>\n             <input type=\"date\" class=\"short\" name=\"expiry_dates[]\" id=\"expiry_dates_${index}\" value=\"\">\n               </td>\n                <td>\n                <input type=\"number\" class=\"short\" min=\"1\" step=\"1\" name=\"expiry_quantities[]\" id=\"expiry_quantities_${index}\" value=\"1\">\n                </td>\n                <td>\n                <input type=\"text\" class=\"short\" name=\"expiry_company[]\"  id=\"expiry_company_${index}\" value=\"\">\n                </td>\n                <td><input type=\"number\" class=\"short\" name=\"expiry_buying_price[]\" min=\"0\" step=\"0.01\" id=\"expiry_buying_price_${index}\" value=\"0\">\n                </td>\n                <td>\n                ${removeButton}\n                </td>\n            </tr>`;\n  }\n\n  // Calculate total expiry quantity.\n  function getTotalExpiryQuantity() {\n    const expiryQuantityFields = expiryInput.find('[id^=\"expiry_quantities_\"]');\n    if (expiryQuantityFields.length === 0 || expiryRule.val() === 'no') {\n      return 0;\n    }\n    return expiryQuantityFields.map(function () {\n      return parseInt($(this).val()) || 0;\n    }).get().reduce((a, b) => a + b, 0);\n  }\n\n  // Update available stock display.\n  function updateStockQuantitiesRealTime() {\n    stockQuantity.val(getTotalExpiryQuantity());\n  }\n\n  // Validate expiry quantity input on change.\n  expiryInput.add($('[id^=\"expiry_quantities_\"]')).on('input scroll', function () {\n    updateStockQuantitiesRealTime();\n  });\n\n  // Hide expiry fields if manage stock is unchecked.\n  manageStock.on('change', function () {\n    if (!manageStock.is(':checked')) {\n      expiryRule.val('no').trigger('change');\n    }\n  });\n\n  // Show or hide expiry fields based on the expiry rule selection.\n  expiryRule.on('change', function () {\n    const rule = $(this).val();\n    if (rule === 'yes') {\n      // Add first expiry field if none exists.\n      if (expiryInput.find('.expiry-field-group').length === 0) {\n        expiryInput.append(createExpiryField(0));\n      }\n      expiryFieldsContainer.show();\n    } else {\n      expiryFieldsContainer.hide().find('.expiry-field-group').remove();\n    }\n    manageStock.prop('checked', rule === 'yes');\n    stockQuantity.prop('disabled', rule === 'yes');\n    $('.stock_fields').css('display', rule === 'yes' ? '' : 'none');\n    updateStockQuantitiesRealTime();\n  });\n\n  // Add a new expiry field on button click.\n  addExpiryButton.on('click', function () {\n    const fieldCount = expiryInput.find('.expiry-field-group').length;\n    expiryInput.append(createExpiryField(fieldCount));\n    updateStockQuantitiesRealTime();\n  });\n\n  // Remove an expiry field on button click.\n  expiryFieldsContainer.on('click', '.remove-expiry-field', function () {\n    $(this).closest('.expiry-field-group').remove();\n    updateStockQuantitiesRealTime();\n  });\n});\n\n//# sourceURL=webpack://wepos/./assets/src/utils/expiryStockManager.js?")}},__webpack_exports__={};__webpack_modules__["./assets/src/utils/expiryStockManager.js"]()})();